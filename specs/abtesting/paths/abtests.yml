post:
  tags:
    - abtesting
  operationId: addABTests
  description: >
    Creates a new A/B test with provided configuration.

    You can set an A/B test on two different indices with different settings, or on the same index with different search parameters by providing a customSearchParameters setting on one of the variants.
  summary: Creates a new A/B test with provided configuration.
  requestBody:
    required: true
    content:
      application/json:
        schema:
          title: addABTestsRequest
          type: object
          additionalProperties: false
          properties:
            name:
              $ref: ../common/parameters.yml#/name
            variant:
              type: array
              description: List of 2 variants for the A/B test.
              minItems: 2
              maxItems: 2
              items:
                $ref: ../common/schemas/AddABTestsVariant.yml#/AddABTestsVariant
            endAt:
              $ref: ../common/parameters.yml#/endAt
          required:
            - name
            - variant
            - endAt
  responses:
    '200':
      description: OK
      content:
        application/json:
          schema:
            title: addABTestsResponse
            type: object
            additionalProperties: false
            properties:
              index:
                $ref: ../common/parameters.yml#/index
              abTestID:
                $ref: ../common/parameters.yml#/abTestID
              taskID:
                $ref: ../common/parameters.yml#/taskID
            required:
              - abTestID
              - index
              - taskID
    '400':
      $ref: ../../common/responses/BadRequest.yml
    '402':
      $ref: ../../common/responses/FeatureNotEnabled.yml
    '403':
      $ref: ../../common/responses/MethodNotAllowed.yml
    '404':
      $ref: ../../common/responses/IndexNotFound.yml

get:
  tags:
    - abtesting
  operationId: listABTests
  description: >
    Fetch all existing A/B tests for App that are available for the current API Key. Returns an array of metadata and metrics. When no data has been processed, the metrics will be returned as null.
  summary: Fetch all existing A/B tests for App that are available for the current API Key.
  parameters:
    - $ref: ../../common/parameters.yml#/Offset
    - $ref: ../../common/parameters.yml#/Limit
  responses:
    '200':
      description: OK
      content:
        application/json:
          schema:
            title: listABTestsResponse
            type: object
            additionalProperties: false
            properties:
              abtests:
                $ref: ../common/schemas/ABTest.yml#/ABTests
              count:
                type: integer
                description: Number of A/B tests found for the app.
              total:
                type: integer
                description: Number of A/B tests retrievable.
            required:
              - abtests
              - count
              - total
    '400':
      $ref: ../../common/responses/BadRequest.yml
    '402':
      $ref: ../../common/responses/FeatureNotEnabled.yml
    '403':
      $ref: ../../common/responses/MethodNotAllowed.yml
    '404':
      $ref: ../../common/responses/IndexNotFound.yml
